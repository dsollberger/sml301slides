{
  "hash": "0c55f76d6464009a349ad5ed58915bc3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"8: Dimension Reduction\"\nauthor: \"Derek Sollberger\"\ndate: \"2025-02-19\"\nformat:\n  html:\n    toc: true\n---\n\n::: {.cell}\n\n:::\n\n\n\n# Session 8: Dimension Reduction\n\n## Learning objectives:\n\n:::: {.columns}\n\n::: {.column width=\"45%\"}\n- Explore PCA and LDA\n:::\n\n::: {.column width=\"10%\"}\n\n:::\n\n::: {.column width=\"45%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::::\n\n\n# Principal Components\n\n## Correlation\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n## Finding Vectors\n\n### PCA Vectors\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nStandard deviations (1, .., p=2):\n[1] 1.2860884 0.5881978\n\nRotation (n x k) = (2 x 2):\n                     PC1        PC2\nbill_length_mm 0.7071068  0.7071068\nbill_depth_mm  0.7071068 -0.7071068\n```\n\n\n:::\n:::\n\n\n\n### Center\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nbill_length_mm  bill_depth_mm \n      47.56807       14.99664 \n```\n\n\n:::\n:::\n\n\n\n### Scale\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nbill_length_mm  bill_depth_mm \n      3.106116       0.985998 \n```\n\n\n:::\n:::\n\n\n\n## New Basis\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## PCA Pairs Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npsych::pairs.panels(gentoo_pca$x)\n```\n\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## PCA Bi Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbiplot::ggbiplot(gentoo_pca,\n                   obs.scale = 1,\n                   var.scale = 1,\n                   varname.color = \"blue\") +\n  labs(title = \"First two principal components\",\n       subtitle = \"correlation: r = 0\",\n       caption = \"SML 301\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n# Principal Component Dimensionality Reduction\n\n\n\n::: {.cell}\n\n:::\n\n\n\n## Correlations\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## Finding Vectors\n\n### PCA Vectors\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nStandard deviations (1, .., p=4):\n[1] 1.6556628 0.8832220 0.6030061 0.3392388\n\nRotation (n x k) = (4 x 4):\n                         PC1        PC2        PC3        PC4\nbill_depth_mm     -0.4025427 0.78620098 -0.4409902  0.1592956\nbill_length_mm     0.4522035 0.61548815  0.6214553 -0.1745843\nflipper_length_mm  0.5766988 0.01567957 -0.2136934  0.7883577\nbody_mass_g        0.5485343 0.05307086 -0.6112742 -0.5680118\n```\n\n\n:::\n:::\n\n\n\n### Center\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    bill_depth_mm    bill_length_mm flipper_length_mm       body_mass_g \n         17.12048          43.93775         201.41365        4219.67871 \n```\n\n\n:::\n:::\n\n\n\n### Scale\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    bill_depth_mm    bill_length_mm flipper_length_mm       body_mass_g \n         2.046068          5.369742         13.843945        797.965089 \n```\n\n\n:::\n:::\n\n\n\n## PCA Pairs Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npsych::pairs.panels(penguin_pca$x)\n```\n\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n## PCA Bi Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbiplot::ggbiplot(penguin_pca,\n                   ellipse = TRUE, ellipse.prob = 0.95,\n                   groups = train_data$species,\n                   obs.scale = 1,\n                   var.scale = 1,\n                   varname.color = \"blue\") +\n  labs(title = \"First two principal components\",\n       subtitle = \"captures 87.4 percent of the variance\",\n       caption = \"SML 301\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n\n# PCA Regression\n\n## Regression Task\n\n* response variable: `body_mass_g`\n* explanatory variables: `bill_depth_mm`, `bill_length_mm`, `flipper_length_mm`\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"MSE: 130265.339625507\"\n```\n\n\n:::\n:::\n\n\n## Dimensionality Reduction\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n## PCA Model\n\n$$\\hat{y} = \\beta_{0} + \\beta_{1}P_{1} + \\beta_{2}P_{2}$$\n\n* $P_{1}$: principal component 1\n* $P_{2}$: principal component 2\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"MSE: 212638.288324684\"\n```\n\n\n:::\n:::\n\n\n\n\n# Activity: Literature Results\n\nWe will look at the results paragraphs for some of the most influential papers in the history of machine learning:\n\n## Adaboost\n\n* A Decision-Theoretic Generalization of on-Line Learning and an Application to Boosting (1997â€”published as abstract in 1995), Freund and Schapire\n\n## AlexNet\n\n* ImageNet Classification with Deep Convolutional Neural Networks (2012)\n\n## DropOut\n\n* Dropout: A Simple Way to Prevent Neural Networks from Overfitting (2014), Srivastava, Hinton, Krizhevsky, Sutskever, and Salakhutdinov\n\n## GANs\n\n* General Adversarial Nets (2014), Goodfellow et al.\n\n## TensorFlow\n\n* TensorFlow: A system for large-scale machine learning (2016), Abadi et al.\n\n## Word2Vec\n\n* Efficient Estimation of Word Representations in Vector Space (2013), Mikolov, Chen, Corrado, and Dean\n\n\n# PCA Classification\n\n## Task\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n## Classifier\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n* PC1 captures variance of the *entire* data set\n\n## Along PC1\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n\n# Toward LDA\n\n## Covariance Revisited\n\n* Naive Bayes ignored covariance (assumed conditional independence)\n* discriminant analyses (generative approach): fit multivariate Gaussians\n* want: dimensionality reduction\n\n**Fisher's linear discriminant analysis** (FLDA) is a hybrid of discriminative and generative techniques, but limited to\n\n$$K \\leq C - 1 \\text{ dimensions}$$\n\n* $C$: number of classes in response variable\n* $D$: number of dimensions in projected space\n\n## FLDA Ideas\n\n* $S_{B}, S_{W}$: scatter matrices (estimate covariance)\n* $W$: projection matrix from $D$ to $K$ dimensions\n\nObjective: maximize\n\n$$J(W) = \\displaystyle\\frac{|W^{T}S_{B}W|}{|W^{T}S_{W}W|}$$\n\n* eigenvalue scenario instead of gradient descent\n\n\n# LDA\n\n> Linear Discriminant Analysis takes the group structure into account\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n\n## Projection\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n## Comparison\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](08_dimension_reduction_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n\n# Quo Vadimus?\n\n:::: {.columns}\n\n::: {.column width=\"40%\"}\n* due this Friday (5 PM):\n\n    - Precept 4\n    - Literature Report\n\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"50%\"}\n![sarcasm](python_rizz.png)\n\n* [image source](https://www.reddit.com/r/csMajors/comments/1h53a03/i_made_a_brainrot_version_of_python/)\n\n:::\n\n::::\n\n\n# Footnotes\n\n::: {.callout-note collapse=\"true\"}\n\n## (optional) Additional Resources and References\n\n* [PCA in R](https://www.r-bloggers.com/2021/05/principal-component-analysis-pca-in-r/) by finnstats\n* [PCR in R](https://www.r-bloggers.com/2016/07/performing-principal-components-regression-pcr-in-r/) by Michy Alice\n\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Session Info\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.2 (2024-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] lubridate_1.9.3      forcats_1.0.0        stringr_1.5.1       \n [4] readr_2.1.5          tidyverse_2.0.0      yardstick_1.3.1     \n [7] workflowsets_1.1.0   workflows_1.1.4      tune_1.2.1          \n[10] tidyr_1.3.1          tibble_3.2.1         rsample_1.2.1       \n[13] recipes_1.0.10       purrr_1.0.4          parsnip_1.2.1       \n[16] modeldata_1.4.0      infer_1.0.7          dplyr_1.1.4         \n[19] dials_1.3.0          scales_1.3.0         broom_1.0.7         \n[22] tidymodels_1.2.0     patchwork_1.3.0      palmerpenguins_0.1.1\n[25] ggtext_0.1.2         GGally_2.2.1         ggbiplot_0.6.2      \n[28] ggplot2_3.5.1       \n\nloaded via a namespace (and not attached):\n [1] mnormt_2.1.1        rlang_1.1.5         magrittr_2.0.3     \n [4] furrr_0.3.1         compiler_4.4.2      vctrs_0.6.5        \n [7] lhs_1.2.0           pkgconfig_2.0.3     fastmap_1.2.0      \n[10] backports_1.5.0     labeling_0.4.3      rmarkdown_2.29     \n[13] markdown_1.13       prodlim_2024.06.25  tzdb_0.4.0         \n[16] xfun_0.50           jsonlite_1.8.9      psych_2.4.12       \n[19] parallel_4.4.2      R6_2.5.1            stringi_1.8.4      \n[22] RColorBrewer_1.1-3  parallelly_1.37.1   rpart_4.1.23       \n[25] Rcpp_1.0.12         iterators_1.0.14    knitr_1.49         \n[28] future.apply_1.11.2 Matrix_1.7-1        splines_4.4.2      \n[31] nnet_7.3-19         timechange_0.3.0    tidyselect_1.2.1   \n[34] rstudioapi_0.17.1   yaml_2.3.10         timeDate_4032.109  \n[37] codetools_0.2-20    listenv_0.9.1       lattice_0.22-6     \n[40] plyr_1.8.9          withr_3.0.2         evaluate_1.0.3     \n[43] future_1.33.2       survival_3.7-0      ggstats_0.7.0      \n[46] xml2_1.3.6          pillar_1.10.1       foreach_1.5.2      \n[49] generics_0.1.3      hms_1.1.3           commonmark_1.9.2   \n[52] munsell_0.5.1       globals_0.16.3      class_7.3-22       \n[55] glue_1.8.0          tools_4.4.2         data.table_1.16.2  \n[58] gower_1.0.1         grid_4.4.2          ipred_0.9-14       \n[61] colorspace_2.1-1    nlme_3.1-166        cli_3.6.3          \n[64] DiceDesign_1.10     lava_1.8.0          gtable_0.3.6       \n[67] pls_2.8-5           GPfit_1.0-8         digest_0.6.37      \n[70] htmlwidgets_1.6.4   farver_2.1.2        htmltools_0.5.8.1  \n[73] lifecycle_1.0.4     hardhat_1.4.0       gridtext_0.1.5     \n[76] MASS_7.3-61        \n```\n\n\n:::\n:::\n\n\n:::\n\n\n:::: {.columns}\n\n::: {.column width=\"45%\"}\n\t\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"45%\"}\n\n:::\n\n::::\n\n::::: {.panel-tabset}\n\n\n\n:::::",
    "supporting": [
      "08_dimension_reduction_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}